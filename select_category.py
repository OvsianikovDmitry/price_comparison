from Book.parsing.price_comparison import *
from Book.parsing.dicts_products import *


gipsokarton = [
        'data_fishka_remonta/Гипсокартон.csv',
        'data_fishka_remonta/Гипсоволокнистый лист.csv',
        'data_mamont/Гипсокартон.csv',
        'data_mamont/Гипсоволокно.csv',
        'data_postroyka/Гипсокартон.csv',
        'data_startStroi/Гипсокартон.csv',
        'data_startStroi/Гипсоволокнистый лист ГВЛВ.csv',
        'data_stroyBaza/Гипсокартон.csv'
    ]

profili_dlya_gk = [
        'data_fishka_remonta/Профиль для гипсокартона.csv',
        'data_mamont/Профили для гипсокартона.csv',
        'data_mamont/Профили для ГКЛ.csv',
        'data_postroyka/Профиль для гипсокартона.csv',
        'data_startStroi/Профиль для гипсокартона.csv',
        'data_stroyBaza/Профиль для гипсокартона.csv'
]

krepej_dlya_profilya_gk = [
        'data_fishka_remonta/Крепеж для профиля.csv',
        'data_mamont/Крепеж для профиля.csv',
        'data_postroyka/Комплектующие для профиля.csv',
        'data_startStroi/Комплектующие для профиля.csv',
        'data_stroyBaza/Комплектующие для профиля.csv'
]

samorez_dubel = [
        'data_fishka_remonta/Метизы и крепеж.csv',
        'data_fishka_remonta/Саморезы для гипсокартона.csv',
        'data_mamont/Дюбели, дюбель-гвозди.csv',
        'data_mamont/Саморезы и шурупы.csv',
        'data_postroyka/Саморезы.csv',
        'data_postroyka/Дюбели.csv',
        'data_startStroi/Саморезы.csv',
        'data_startStroi/Анкеры.csv',
        'data_startStroi/Дюбеля.csv',
        'data_startStroi/Зонты для утеплителей.csv',
        'data_stroyBaza/Дюбель гвозди.csv',
        'data_stroyBaza/Саморезы.csv',
]

grunt_kraski = [
        'data_fishka_remonta/Грунты.csv',
        'data_mamont/Грунтующие краски.csv',
        'data_mamont/Грунтовки.csv',
        'data_mamont/Бетон-контакт.csv',
        'data_postroyka/Грунтовки.csv',
        'data_startStroi/Грунтовки.csv',
        'data_startStroi/Грунт.csv',
        'data_stroyBaza/Грунтовка и грунт для подготовки основания.csv'

]

shpatlevka = [
        'data_fishka_remonta/Шпатлевки.csv',
        'data_mamont/Шпатлевка.csv',
        'data_postroyka/Шпатлёвка.csv',
        'data_startStroi/Шпатлевки.csv',
        'data_stroyBaza/Шпатлевка для стен и потолка.csv'
]


shtukaturka = [
        'data_fishka_remonta/Штукатурки.csv',
        'data_mamont/Штукатурка.csv',
        'data_postroyka/Штукатурка.csv',
        'data_startStroi/Штукатурки.csv',
        'data_startStroi/Мозаичная Штукатурка.csv',
        'data_startStroi/Декоративные штукатурки (готовые).csv',
        'data_stroyBaza/Штукатурка.csv',
        'data_stroyBaza/Фасадная структурная штукатурка (короед, камешковая и шуба).csv'

]

steklosetki = [
        'data_fishka_remonta/Стеклохолст и сетка.csv',
        'data_mamont/Стеклообои.csv',
        'data_mamont/Стеклосетка.csv',
        'data_mamont/Стеклохолст (паутинка).csv',
        'data_postroyka/Стеклосетки.csv',
        'data_postroyka/Стеклохолст, клей.csv',
        'data_startStroi/Стеклосетки.csv',
        'data_startStroi/Стеклохолст.csv',
        'data_startStroi/Сетка сварная.csv',
        'data_stroyBaza/Сетка штукатурная.csv',
        'data_stroyBaza/Стеклохолст и стеклообои.csv'
]


lenty_ugolki = [
        'data_fishka_remonta/Ленты для углов.csv',
        'data_fishka_remonta/Уголки и маяки.csv',
        'data_mamont/Ленты, серпянки.csv',
        'data_mamont/Уголки малярные.csv',
        'data_mamont/Уголки перфорированные.csv',
        'data_postroyka/Серпянки, ленты.csv',
        'data_postroyka/Уголки пластиковые.csv',
        'data_startStroi/Серпянки.csv',
        'data_startStroi/Уголки малярные.csv',
        'data_startStroi/Бумажные перфорированные.csv',
        'data_stroyBaza/Углы.csv',
        'data_stroyBaza/Уголки перфорированные.csv'
]


smesi_dlya_pola = [
        'data_postroyka/Серпянки, ленты.csv',
        'data_fishka_remonta/Смеси для пола.csv',
        'data_mamont/Смеси для пола.csv',
        'data_mamont/Цемент и песок.csv',
        'data_postroyka/Самонивелиры, стяжки.csv',
        'data_startStroi/Самонивелиры, Стяжки, добавки в бетон.csv',
        'data_startStroi/Цемент, Песок, Керамзит.csv',
        'data_stroyBaza/Стяжка пола и самонивелир.csv'

]

kley_dlya_pautinki = [
        'data_fishka_remonta/Клей для стеклообоев.csv',
        'data_mamont/Стеклохолст (паутинка).csv',
        'data_postroyka/Стеклохолст, клей.csv',
        'data_startStroi/Клей для стеклохолста, обоев.csv',
        'data_stroyBaza/Стеклохолст и стеклообои.csv'
]

plitochni_kley = [
        'data_fishka_remonta/Клей для плитки.csv',
        'data_mamont/Клеевые смеси.csv',
        'data_postroyka/Клей для плитки.csv',
        'data_startStroi/Клея для плитки.csv',
        'data_stroyBaza/Клей для плитки.csv'

]

utepliteli = [
       'data_fishka_remonta/Пенопласт.csv',
       'data_fishka_remonta/Пенополистирол.csv',
       'data_fishka_remonta/Утеплитель.csv',
       'data_mamont/Фасадный утеплитель.csv',
       'data_mamont/Экструдированный пенополистирол.csv',
       'data_postroyka/Пенопласт.csv',
       'data_postroyka/Пеноплэкс, Батэплекс, Техноплекс.csv',
       'data_postroyka/Минеральная вата.csv',
       'data_startStroi/Минеральная вата.csv',
       'data_startStroi/Пенопласт.csv',
       'data_startStroi/Пеноплекс Техноплекс Истплекс Батэплекс.csv',
       'data_stroyBaza/Минеральная вата (утеплитель).csv',
       'data_stroyBaza/Пенопласт, пеноплекс, пенополистирол.csv'

]

germetiki = [
        'data_fishka_remonta/Герметики.csv',
        'data_mamont/Клеи, герметики, пена.csv',
        'data_postroyka/Ceresit.csv',
        'data_postroyka/Герметики.csv',
        'data_postroyka/Клеи.csv',
        'data_startStroi/Герметик, Силикон.csv',
        'data_startStroi/Клей-герметик (жидкие гвозди).csv',
        'data_stroyBaza/Герметик и силикон.csv',
        'data_stroyBaza/Клей монтажный.csv'


]

malyarka_i_ukrivka = [
        'data_fishka_remonta/Малярная лента.csv',
        'data_postroyka/Серпянки, ленты.csv',
        'data_mamont/Ленты, скотч.csv'
        'data_startStroi/Ленты малярные.csv',

]

def select_cat():
    category ={
        1:'Гипсокартон и ГВЛ',
        2:'Профили для г/к',
        3:'Комплектующие для профиля',
        4:'Дюбеля и саморезы',
        5:'Грунтовки и грунткраски',
        6:'Шпатлёвки',
        7:'Штукатурка',
        8:'Сетки штукатурные и стеклохолст',
        9:'Ленты для углов Перфорированные и штукатурные углы',
        10:'Стяжка и нивелиры',
        11:'Клей для паутинки',
        12:'Клей для плитки',
        13:'Утеплители',
        14:'Герметики',
        15:'Малярки и укрывка',
        16:'Маяки штукатурные',
        17:'Клей для теплоизоляции',
        18:'Монтажная и клей-пена'
    }

    dict_tovar = {}
    for k,v in category.items():
        print(k,v)

    try:
        product = int(input('Какой номер категории'))
    except ValueError:
        print('Нужна цифра')
        product = int(input('Какой номер категории'))

    if product == 1:
        name = tovar_name()
        if name == 'Гипсокартон':
            for i in gipsokarton:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar = i.lower()
                    name = name.casefold()

                    if name in search_tovar:
                        price = tovar_price(search_tovar)
                        dict_tovar[y[0]+' '+search_tovar] = price



            thikness = thikness_gk()
            leight = leight_gk()

            new_dict = {}

            for k, v in dict_tovar.items():
                search_key = k.casefold()

                if thikness[2] in search_key and leight[0] in search_key:
                    price = tovar_price(search_key)
                    new_dict[search_key] = price
                elif thikness[2] in search_key and leight[1] in search_key:
                    price = tovar_price(search_key)
                    new_dict[search_key] = price
                elif thikness[1] in search_key and leight[0] in search_key:
                    price = tovar_price(search_key)
                    new_dict[search_key] = price
                elif thikness[1] in search_key and leight[1] in search_key :
                    price = tovar_price(search_key)
                    new_dict[search_key] = price



            for k, v in new_dict.items():
                if v == min(new_dict.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(new_dict)

        elif name == 'Гипсоволокнистый лист':
            for i in gipsokarton:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar = i.lower()
                    name = name.casefold()

                    if name in search_tovar:
                        price = tovar_price(search_tovar)
                        dict_tovar[y[0] + ' ' + search_tovar] = price

            thikness = thikness_gipsovolokno()
            leight = leight_gipsovolokno()

            new_dict = {}

            for k, v in dict_tovar.items():
                search_key = k.casefold()

                if thikness[0] in search_key and leight[0] in search_key:
                    price = tovar_price(search_key)
                    new_dict[search_key] = price
                elif thikness[0] in search_key and leight[1] in search_key:
                    price = tovar_price(search_key)
                    new_dict[search_key] = price
                elif thikness[1] in search_key and leight[0] in search_key:
                    price = tovar_price(search_key)
                    new_dict[search_key] = price
                elif thikness[1] in search_key and leight[1] in search_key:
                    price = tovar_price(search_key)
                    new_dict[search_key] = price

            for k, v in new_dict.items():
                if v == min(new_dict.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(new_dict)
        elif name == 'Элемент пола':
            for i in gipsokarton:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar = i.lower()
                    name = name.casefold()

                    if name in search_tovar:
                        price = tovar_price(search_tovar)
                        dict_tovar[y[0] + ' ' + search_tovar] = price

            thikness = thikness_superpol()

            new_dict = {}

            for k, v in dict_tovar.items():
                search_key = k.casefold()

                if thikness[0] in search_key:
                    price = tovar_price(search_key)
                    new_dict[search_key] = price

            for k, v in new_dict.items():
                if v == min(new_dict.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(new_dict)


    elif product == 2:
        name = tovar_name_profil()
        name_1=[]
        name_1.append(name[-5:])
        name_1.append(name[-2:]+ 'x' + name[-5:-3])

        for i in profili_dlya_gk:
            y = i.split('/')

            tovar = open_list(i)
            for i in tovar:
                search_tovar = i.lower()
                name = name.casefold()

                if name_1[0] in search_tovar or name_1[1] in search_tovar:
                    price = price_profil(search_tovar)
                    dict_tovar[y[0] + ' ' + search_tovar] = price

        for k, v in dict_tovar.items():
            if v == min(dict_tovar.values()):
                print(k, v)
                print('=' * 200)
        all_product(dict_tovar)

    elif product == 3:
        name = krepej_profil()
        if name == 'Соединитель':
            name_1 = ['удлинитель профилей','удлинитель для профиля','соединитель профилей']
            for i in krepej_dlya_profilya_gk:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar = i.lower()


                    if name_1[0] in search_tovar or name_1[1] in search_tovar or name_1[2] in search_tovar:
                        price = price_profil(search_tovar)
                        dict_tovar[y[0] + ' ' + search_tovar] = price

            for k, v in dict_tovar.items():
                if v == min(dict_tovar.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(dict_tovar)
        elif name == 'Подвес удлинённый':
            name_1 = ['46 см', '460', 'подвес удлинённый']
            for i in krepej_dlya_profilya_gk:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar = i.lower()

                    if name_1[0] in search_tovar or name_1[1] in search_tovar or name_1[2] in search_tovar:
                        price = price_profil(search_tovar)
                        dict_tovar[y[0] + ' ' + search_tovar] = price

            for k, v in dict_tovar.items():
                if v == min(dict_tovar.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(dict_tovar)
        else:
            for i in krepej_dlya_profilya_gk:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar = i.lower()
                    name = name.casefold()

                    if name in search_tovar :
                        price = price_profil(search_tovar)
                        dict_tovar[y[0] + ' ' + search_tovar] = price

            for k, v in dict_tovar.items():
                if v == min(dict_tovar.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(dict_tovar)

    elif product == 4:

        name = samorezi_and_dubeli()
        if name == 'Саморез до 16 мм':
            name_1 = ['3,5х9,5','3,5х11','3,9*11','4,2х13','4,2*16','3,5 х 9,5', '4,2 х 13', '4.2*13','4.2*16','3.9*11','3.5*11']
            for i in samorez_dubel:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ','')
                    for dlina in name_1:
                        if dlina in search_tovar :
                            price = price_samorez(search_tovar)
                            dict_tovar[y[0] + ' ' + search_tovar_1] = price

            for k, v in dict_tovar.items():
                if v == min(dict_tovar.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(dict_tovar)

        elif name == 'Саморез от 17 до 25 мм':
            name_1 = ['4,2*19','3,5*25','3.5x25','3.5*25','3.9*25','4.2*25','3.9*19','3.9*23','4.2*19','3,9х25','3,9х23','4,2 х 19','3,5 х 25']
            for i in samorez_dubel:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ','')
                    for dlina in name_1:
                        if dlina in search_tovar :
                            price = price_samorez(search_tovar)
                            dict_tovar[y[0] + ' ' + search_tovar_1] = price

            for k, v in dict_tovar.items():
                if v == min(dict_tovar.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(dict_tovar)

        elif name == 'Саморез от 30 до 40 мм':
            name_1 = ['3,9x38','3,5 х 35','5,5x38','3.9x38','3,9x35','3,5*35','3,5x35','3.5*35','3.9*35','3.9*38',
                      '4.3*35','4,8*32','4,8*38','5.5*38','4.2*39','4,0*40','3,0*30']
            for i in samorez_dubel:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ','')
                    for dlina in name_1:
                        if dlina in search_tovar :
                            price = price_samorez(search_tovar)
                            dict_tovar[y[0] + ' ' + search_tovar_1] = price

            for k, v in dict_tovar.items():
                if v == min(dict_tovar.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(dict_tovar)

        elif name == 'Саморез от 40 до 50 мм':
            name_1 = ['3,5х45','3.5*45','3,5* 45','4,5*45','4.2*41','4,8*45','3,5 х 45','4,2 х 40']
            for i in samorez_dubel:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ','')
                    for dlina in name_1:
                        if dlina in search_tovar :
                            price = price_samorez(search_tovar)
                            dict_tovar[y[0] + ' ' + search_tovar_1] = price

            for k, v in dict_tovar.items():
                if v == min(dict_tovar.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(dict_tovar)

        elif name == 'Саморез от 50 до 60 мм':
            name_1 = ['3,5*55','4,5*60','4,0*60','4,5*60','3.5*51','3.5*55','3,5 х 51','3,5 х 55','3.9x55']
            for i in samorez_dubel:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ','')
                    for dlina in name_1:
                        if dlina in search_tovar :
                            price = price_samorez(search_tovar)
                            dict_tovar[y[0] + ' ' + search_tovar_1] = price

            for k, v in dict_tovar.items():
                if v == min(dict_tovar.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(dict_tovar)

        elif name == 'Саморез от 60 до 70 мм':
            name_1 = ['4,5*60', '4,0*60', '4,5*60','4,2 х 70','4.2*70','6х70','8х70','4,3х65']
            for i in samorez_dubel:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ','')
                    for dlina in name_1:
                        if dlina in search_tovar :
                            price = price_samorez(search_tovar)
                            dict_tovar[y[0] + ' ' + search_tovar_1] = price

            for k, v in dict_tovar.items():
                if v == min(dict_tovar.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(dict_tovar)

        elif name == 'Саморез от 70 до 80 мм':
            name_1 = ['8*80','8х70','4,2 х 70','4.2*70','6х70']
            for i in samorez_dubel:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ','')
                    for dlina in name_1:
                        if dlina in search_tovar :
                            price = price_samorez(search_tovar)
                            dict_tovar[y[0] + ' ' + search_tovar_1] = price

            for k, v in dict_tovar.items():
                if v == min(dict_tovar.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(dict_tovar)

        elif name == 'Саморез от 80 до 90 мм':
            name_1 = ['8*80','4,2 х 90']
            for i in samorez_dubel:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ', '')
                    for dlina in name_1:
                        if dlina in search_tovar:
                            price = price_samorez(search_tovar)
                            dict_tovar[y[0] + ' ' + search_tovar_1] = price

            for k, v in dict_tovar.items():
                if v == min(dict_tovar.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(dict_tovar)

        elif name == 'Саморез свыше 90 мм':
            name_1 = ['4,2 х 90','12х100','6,0*140','6,0*200','8*120','4,8*90']
            for i in samorez_dubel:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ', '')
                    for dlina in name_1:
                        if dlina in search_tovar:
                            price = price_samorez(search_tovar)
                            dict_tovar[y[0] + ' ' + search_tovar_1] = price

            for k, v in dict_tovar.items():
                if v == min(dict_tovar.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(dict_tovar)

        elif name == 'Дюбель-гвоздь длина 40 мм':
             name_1 = ['6*40','6х40','8*40','6L*40','6K*40','6 х 40']
             for i in samorez_dubel:
                 y = i.split('/')

                 tovar = open_list(i)
                 for i in tovar:
                     search_tovar_1 = i
                     search_tovar = i.lower().replace(' ', '')
                     for dlina in name_1:
                         if dlina in search_tovar:
                             price = price_samorez(search_tovar)
                             dict_tovar[y[0] + ' ' + search_tovar_1] = price

             for k, v in dict_tovar.items():
                 if v == min(dict_tovar.values()):
                     print(k, v)
                     print('=' * 200)
             all_product(dict_tovar)

        elif name == 'Дюбель-гвоздь длина 60 мм':
            name_1 = ['6x60','8*60','6*60','6L*60','6К*60','6 х 60']
            for i in samorez_dubel:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ', '')
                    for dlina in name_1:
                        if dlina in search_tovar:
                            price = price_samorez(search_tovar)
                            dict_tovar[y[0] + ' ' + search_tovar_1] = price

            for k, v in dict_tovar.items():
                if v == min(dict_tovar.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(dict_tovar)

        elif name == 'Дюбель-гвоздь длина 80 мм':
            name_1 = ['6*80','6 х 80','14х80','8*80','10x80']
            for i in samorez_dubel:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ', '')
                    for dlina in name_1:
                        if dlina in search_tovar:
                            price = price_samorez(search_tovar)
                            dict_tovar[y[0] + ' ' + search_tovar_1] = price

            for k, v in dict_tovar.items():
                if v == min(dict_tovar.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(dict_tovar)

        elif name == 'Дюбель для теплоизоляции':
            name_1 = ['теплоизоляции']
            for i in samorez_dubel:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ', '')
                    for dlina in name_1:
                        if dlina in search_tovar:
                            price = price_samorez(search_tovar)
                            dict_tovar[y[0] + ' ' + search_tovar_1] = price

            for k, v in dict_tovar.items():
                if v == min(dict_tovar.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(dict_tovar)

    elif product == 5:
        new_dict ={}
        name = grunt_kraska()
        if name == 'Грунт глубокого проникновения':
            name_1 = ['концентрат','суперконцентрат','мультигрунд','tiefengrund','грунт-концентрат','универсальный',
                      'глубоко-проникающая','укрепляющая','глубокого проникновения']
            for i in grunt_kraski:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ', '')
                    for dlina in name_1:
                        if dlina in search_tovar:
                            price = price_samorez(search_tovar)
                            dict_tovar[y[0] + ' ' + search_tovar_1] = price


            name = volume_grunt()
            if name == '1л':
                for k,v in dict_tovar.items():
                    x = vol_grunt_1(k)
                    if x:
                        new_dict[k] = v

            elif name == '2л':
                for k,v in dict_tovar.items():
                    x = vol_grunt_2(k)
                    if x:
                        new_dict[k] = v

            elif name == '5л':
                for k,v in dict_tovar.items():
                    x = vol_grunt_5(k)
                    if x:
                        new_dict[k] = v

            elif name == '10л':
                for k,v in dict_tovar.items():
                    x = vol_grunt_10(k)
                    if x:
                        new_dict[k] = v

        elif name == 'Грунт-краска':
            name_1 = ['с кварцевым','укрывающая','грунт-краска','grund-farbe','quarz-grund','грунтующая краска','ct16']
            for i in grunt_kraski:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ', '')
                    for dlina in name_1:
                        if dlina in search_tovar:
                            price = price_samorez(search_tovar)
                            dict_tovar[y[0] + ' ' + search_tovar_1] = price


            name = volume_grunt_kraska()
            if name == '1-3':
                for k,v in dict_tovar.items():
                    x = vol_grunt_kraska_1_3(k)
                    if x:
                        new_dict[k] = v
            elif name == '4-5':
                for k,v in dict_tovar.items():
                    x = vol_grunt_kraska_4_5(k)
                    if x:
                        new_dict[k] = v

            elif name == '10':
                for k,v in dict_tovar.items():
                    x = vol_grunt_kraska_10(k)
                    if x:
                        new_dict[k] = v

            elif name == '15+':
                for k,v in dict_tovar.items():
                    x = vol_grunt_kraska_15(k)
                    if x:
                        new_dict[k] = v

        elif name == 'Бетон-контакт':
            name_1 = ['бетонконтакт', 'адгезионная', 'ct19','бетон-контакт','ct-19']
            for i in grunt_kraski:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ', '')
                    for dlina in name_1:
                        if dlina in search_tovar:
                            price = price_samorez(search_tovar)
                            dict_tovar[y[0] + ' ' + search_tovar_1] = price

            name = volume_beton_kontakt()
            if name == 'до 4 кг':
                for k, v in dict_tovar.items():
                    x = vol_betonkontakt_4(k)
                    if x:
                        new_dict[k] = v

            elif name == '7,5 кг':
                for k, v in dict_tovar.items():
                    x = vol_betonkontakt_7(k)
                    if x:
                        new_dict[k] = v

            elif name == '15 кг':
                for k, v in dict_tovar.items():
                    x = vol_betonkontakt_15(k)
                    if x:
                        new_dict[k] = v

        for k, v in new_dict.items():
            if v == min(new_dict.values()):
                print(k, v)
                print('=' * 200)
        all_product(new_dict)


    elif product == 6:

        name = shpatlevka_type()
        if name == 'Готовая в вёдрах':
            name_1 = ['готовая','pasta','volma-cream','cream','паста','sp21','fs20','крышка','sheetrock','шитрок']
            for i in shpatlevka:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ', '')
                    for i in name_1:
                        if i in search_tovar:
                            price = price_samorez(search_tovar)
                            dict_tovar[y[0] + ' ' + search_tovar_1] = price

            name = shpatlevka_vol()
            new_dict = {}
            if name == 'до 10 кг':
                for k, v in dict_tovar.items():
                    x = shpatlevka_do_10(k)
                    if x:
                        new_dict[k] = v

            elif name == '15-20 кг':
                for k, v in dict_tovar.items():
                    x = shpatlevka_15_20(k)
                    if x:
                        new_dict[k] = v

            elif name == 'свыше 20':
                for k, v in dict_tovar.items():
                    x = shpatlevka_20(k)
                    if x:
                        new_dict[k] = v
        elif name == 'В мешках':
            name_1 = ['цементная','гипсовая','jet','lr+','turbo','6440','мешок','цементной']
            name_2 = 'штукатурка'
            name_3 = 'для мусора'
            for i in shpatlevka:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ', '')
                    for i in name_1:
                        if i in search_tovar and name_2 not in search_tovar and name_3 not in search_tovar:
                            price = price_samorez(search_tovar)
                            dict_tovar[y[0] + ' ' + search_tovar_1] = price


            name = shpatlevka_meshok()
            new_dict = {}
            if name == 'Цементная':
                name_1 = 'цементная'
                for k, v in dict_tovar.items():
                    k.lower()
                    if name_1 in k:
                        new_dict[k] = v

            elif name == 'Гипсовая,Полимерная':
                name_1 = ['швов','uniflott','uniflot','унифлот','fugen','фуген','цементная','для мусора','стыков','шов','цементной','унихард']
                for k,v in dict_tovar.items():
                    x = k.lower()
                    count = 0
                    for i in name_1:
                        if i not in x:
                            count +=1
                            if count == 12:
                                new_dict[k] = v

            elif name == 'Для швов':
                name_1 = ['швов', 'uniflott', 'uniflot', 'унифлот', 'fugen', 'фуген','стыков', 'шов','унихард']
                for k, v in dict_tovar.items():
                    x = k.lower()
                    for i in name_1:
                        if i in x:
                            new_dict[k] = v

        for k, v in new_dict.items():
            if v == min(new_dict.values()):
                print(k, v)
                print('=' * 200)
        all_product(new_dict)

    elif product == 7:
        name = shtukaturka_type()
        new_dict = {}
        if name == 'Цементная':
            name_1 = ['цементная','наружных''штукатурно-клеевая']
            name_2 = 'шпатлёвка'
            name_3 = 'шпаклёвка'
            name_4 = 'шпатлевка'
            for i in shtukaturka:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ', '')
                    for i in name_1:
                        if i in search_tovar and name_2 not in search_tovar and name_3 not in search_tovar and name_4 not in search_tovar:
                            price = price_samorez(search_tovar)
                            new_dict[y[0] + ' ' + search_tovar_1] = price

        elif name == 'Гипсовая':
            name_1 = ['гипсовая']
            name_2 = 'шпатлёвка'
            name_3 = 'шпаклёвка'
            name_4 = 'шпатлевка'
            for i in shtukaturka:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ', '')
                    for i in name_1:
                        if i in search_tovar and name_2 not in search_tovar and name_3 not in search_tovar and name_4 not in search_tovar:
                            price = price_samorez(search_tovar)
                            new_dict[y[0] + ' ' + search_tovar_1] = price

        elif name == 'Декоративная':
            name_1 = ['декоратив','камешковая','короед','корник','шуба','структурная','фактурная','венецианская','шагрень','декоративная']
            for i in shtukaturka:
                y = i.split('/')

                tovar = open_list(i)
                for i in tovar:
                    search_tovar_1 = i
                    search_tovar = i.lower().replace(' ', '')
                    for i in name_1:
                        if i in search_tovar:
                            price = price_decorativa(search_tovar)
                            new_dict[y[0] + ' ' + search_tovar_1] = price



        for k, v in new_dict.items():
            if v == min(new_dict.values()):
                print(k, v)
                print('=' * 200)
        all_product(new_dict)

    elif product == 8:
        new_dict = {}
        name_1 = ['стеклосетка','стеклохолст','стеклообои','холст','сетка']

        for i in steklosetki:
            y = i.split('/')
            tovar = open_list(i)
            for i in tovar:
                search_tovar_1 = i

                search_tovar = i.lower()
                for i in name_1:
                    if i in search_tovar:
                        price = price_steklosetki(search_tovar)
                        dict_tovar[y[0] + ' ' + search_tovar_1] = price

        name = steklosetka_list()
        if name == 'Сетка штукатурная':
            name_1 = ['штукатурки','штукатурная','фасадная','малярная']
            for k,v in dict_tovar.items():
                k.lower()
                for i in name_1:
                    if re.search(f"\\b{i}\\b", x):
                        new_dict[k] = float(v)

        elif name == 'Стеклохолст малярный':
            name_1 = ['стеклохолст', 'паутинка', 'стеклообои', 'холст']
            for k, v in dict_tovar.items():
                k.lower()
                for i in name_1:
                    if re.search(f"\\b{i}\\b", x):
                        new_dict[k] = float(v)
        elif name == 'Сетка сварная':
            name_1 = ['сварная', 'просечно', 'кладки', 'стяжки']
            for k, v in dict_tovar.items():
                k.lower()
                for i in name_1:
                    if re.search(f"\\b{i}\\b", x):
                        new_dict[k] = float(v)

        for k, v in new_dict.items():
            if v == min(new_dict.values()):
                print(k, v)
                print('=' * 200)
        all_product(new_dict)

    elif product == 9:
        new_dict = {}
        name_1 = ['стыков','швов','курт','серпянка','углов','угла','уголок','угол']
        for i in lenty_ugolki:
            y = i.split('/')
            tovar = open_list(i)
            for i in tovar:
                search_tovar_1 = i

                search_tovar = i.lower()
                for i in name_1:
                    if i in search_tovar:
                        price = price_steklosetki(search_tovar)
                        dict_tovar[y[0] + ' ' + search_tovar_1] = price
        name = lenti_ugly()
        if name == 'Ленты для стыков':
            name_1 = ['стыков','швов','курт','серпянка']
            for k, v in dict_tovar.items():
                x = k.lower()
                for i in name_1:
                    if re.search(f"\\b{i}\\b", x):
                        new_dict[k] = float(v)
        elif name == 'Ленты для углов':
            name_1 = ['углов','угла']
            for k, v in dict_tovar.items():
                x = k.lower()
                for i in name_1:
                    if re.search(f"\\b{i}\\b", x):
                        new_dict[k] = float(v)

        elif name == 'Уголки перфорированные':
            name_1 = ['уголок','угол']
            for k, v in dict_tovar.items():
                x = k.lower()
                for i in name_1:
                    if re.search(f"\\b{i}\\b", x):
                        new_dict[k] = float(v)

        for k, v in new_dict.items():
            if v == min(new_dict.values()):
                print(k, v)
                print('=' * 200)
        all_product(new_dict)

    elif product == 10:
        new_dict = {}
        name_1 = ['стяжка', 'самонивелир', 'самонивелирующаяся', 'стяжки', 'керамзитовая', 'гравий', 'щебень', 'стяжек',
                  'демпферная','кромочная','бетон-монолит','цемент','песок','керамзит','фибра']
        for i in smesi_dlya_pola:
            y = i.split('/')
            tovar = open_list(i)
            for i in tovar:
                search_tovar_1 = i

                search_tovar = i.lower()
                for i in name_1:
                    if i in search_tovar:
                        price = price_steklosetki(search_tovar)
                        dict_tovar[y[0] + ' ' + search_tovar_1] = price

        name = smesi_pola()

        if name == 'Стяжка':
            name_1 = ['стяжка','стяжек','пескобетон']
            for k, v in dict_tovar.items():
                x = k.lower()
                for i in name_1:
                    if re.search(f"\\b{i}\\b", x):
                        new_dict[k] = float(v)
        elif name == 'Самонивелир':
            name_1 = ['самонивелир','самонивелирующаяся',]
            for k, v in dict_tovar.items():
                x = k.lower()
                for i in name_1:
                    if re.search(f"\\b{i}\\b", x):
                        new_dict[k] = float(v)

        elif name == 'Песок, щебень, керамзит, фибра':
            name_1 = ['керамзитовая', 'гравий', 'щебень','песок','керамзит','фибра']
            for k, v in dict_tovar.items():
                x = k.lower()
                for i in name_1:
                    if i in x:
                        new_dict[k] = float(v)

        elif name == 'Лента демпферная':
            name_1 = ['демпферная', 'кромочная']
            for k, v in dict_tovar.items():
                x = k.lower()
                for i in name_1:
                    if re.search(f"\\b{i}\\b", x):
                        new_dict[k] = float(v)

        elif name == 'Цемент':
            name_1 = ['портландцемент','цемент']

            for k, v in dict_tovar.items():
                x = k.lower()
                for i in name_1:
                    if re.search(f"\\b{i}\\b", x):
                        new_dict[k] = float(v)

        for k, v in new_dict.items():
            if v == min(new_dict.values()):
                print(k, v)
                print('=' * 200)
        all_product(new_dict)

    elif product == 11:
        name_1 = ['стеклохолста','стеклообоев']
        for i in kley_dlya_pautinki:
            y = i.split('/')
            tovar = open_list(i)
            for i in tovar:
                search_tovar_1 = i

                search_tovar = i.lower()
                for i in name_1:
                    if i in search_tovar:
                        price = price_steklosetki(search_tovar)
                        dict_tovar[y[0] + ' ' + search_tovar_1] = float(price)

        for k, v in dict_tovar.items():
            if v == min(dict_tovar.values()):
                print(k, v)
                print('=' * 200)
        all_product(dict_tovar)

    elif product == 12:
        name_1 = ['плитки', 'мозаики','греса','мрамора']
        for i in plitochni_kley:
            y = i.split('/')
            tovar = open_list(i)
            for i in tovar:
                search_tovar_1 = i

                search_tovar = i.lower()
                for i in name_1:
                    if i in search_tovar:
                        price = price_steklosetki(search_tovar)
                        dict_tovar[y[0] + ' ' + search_tovar_1] = float(price)

        for k, v in dict_tovar.items():
            if v == min(dict_tovar.values()):
                print(k, v)
                print('=' * 200)
        all_product(dict_tovar)

    elif product == 13:
        new_dict = {}
        penoplast_dict = {}
        name_1 = ['пенополистирольная','пенополистирол','плита','вата','утеплитель','теплозвукоизоляция','теплоизоляция',
                  'пенопласт','толщина','теплоизоляционная','пеноплекс','техноплекс','истплекс','изовер','пеноплэкс']
        for i in utepliteli:
            y = i.split('/')
            tovar = open_list(i)
            for i in tovar:
                search_tovar_1 = i

                search_tovar = i.lower()
                for i in name_1:
                    if i in search_tovar:
                        price = price_steklosetki(search_tovar)
                        dict_tovar[y[0] + ' ' + search_tovar_1] = price

        name = utepliteli_type()
        if name == 'Пенопласт':
            name_1 = ['плита пенополистирольная','пенопласт']
            for k, v in dict_tovar.items():
                x = k.lower()
                for i in name_1:
                    if re.search(f"\\b{i}\\b", x):
                        new_dict[k] = float(v)


            name = penoplast_tolshina()
            if name == '20 мм':
                name_1 = ['20мм','20 мм','2см','2 см','х20мм', 'x20 мм']
                for k, v in new_dict.items():
                    x = k.lower()
                    for i in name_1:
                        if re.search(i, x):
                            penoplast_dict[k] = float(v)

            elif name == '30 мм':
                name_1 = ['30мм','30 мм','3см','3 см','х30мм','x30 мм']
                for k, v in new_dict.items():
                    x = k.lower()
                    for i in name_1:
                        if re.search(i, x):
                            penoplast_dict[k] = float(v)


            elif name == '50 мм':
                name_1 = ['50мм','50 мм','5см','5 см','х50мм','х50 мм']
                for k, v in new_dict.items():
                    x = k.lower()
                    for i in name_1:
                        if re.search(i, x):
                            penoplast_dict[k] = float(v)

            elif name == '100 мм':
                name_1 = ['100мм','100 мм','10см','10 см','х100мм','х100 мм']
                for k, v in new_dict.items():
                    x = k.lower()
                    for i in name_1:
                        if re.search(i, x):
                            penoplast_dict[k] = float(v)

            try:
                for k, v in penoplast_dict.items():
                    if v == min(penoplast_dict.values()):
                        print(k, v)
                        print('=' * 200)
                all_product(penoplast_dict)
            except TypeError:
                print('Таких товаров нет')

        elif name == 'Экструдированный пенополистирол':
            name_1 = ['пеноплэкс','батэплекс','техноплекс','технониколь','истплекс','пеноплекс']
            for k, v in dict_tovar.items():
                x = k.lower()
                for i in name_1:
                    if re.search(f"\\b{i}\\b", x):
                        new_dict[k] = float(v)
            name = extrudirovani()
            if name == '20 мм':
                name_1 = ['20мм', '20 мм', '2см', '2 см', 'х20мм', 'x20 мм']
                for k, v in new_dict.items():
                    x = k.lower()
                    for i in name_1:
                        if re.search(i, x):
                            penoplast_dict[k] = float(v)

            elif name == '30 мм':
                name_1 = ['30мм', '30 мм', '3см', '3 см', 'х30мм', 'x30 мм']
                for k, v in new_dict.items():
                    x = k.lower()
                    for i in name_1:
                        if re.search(i, x):
                            penoplast_dict[k] = float(v)

            elif name == '40 мм':
                name_1 = ['40мм', '40 мм', '4см', '4 см', 'х40мм', 'x40 мм']
                for k, v in new_dict.items():
                    x = k.lower()
                    for i in name_1:
                        if re.search(i, x):
                            penoplast_dict[k] = float(v)

            elif name == '50 мм':
                name_1 = ['50мм', '50 мм', '5см', '5 см', 'х50мм', 'x50 мм']
                for k, v in new_dict.items():
                    x = k.lower()
                    for i in name_1:
                        if re.search(i, x):
                            penoplast_dict[k] = float(v)

            elif name == '60 мм':
                name_1 = ['60мм', '60 мм', '6см', '6 см', 'х60мм', 'x60 мм']
                for k, v in new_dict.items():
                    x = k.lower()
                    for i in name_1:
                        if re.search(i, x):
                            penoplast_dict[k] = float(v)

            elif name == '80 мм':
                name_1 = ['80мм', '80 мм', '8см', '8 см', 'х80мм', 'x80 мм']
                for k, v in new_dict.items():
                    x = k.lower()
                    for i in name_1:
                        if re.search(f"\\D{i}", x):
                            penoplast_dict[k] = float(v)

            elif name == '100 мм':
                name_1 = ['100мм', '100 мм', '10см', '10 см', 'х100мм', 'x100 мм']
                for k, v in new_dict.items():
                    x = k.lower()
                    for i in name_1:
                        if re.search(f"\\D{i}", x):
                            penoplast_dict[k] = float(v)
            try:
                for k, v in penoplast_dict.items():
                    if v == min(penoplast_dict.values()):
                        print(k, v)
                        print('=' * 200)
                all_product(penoplast_dict)
            except TypeError:
                    print('Таких товаров нет')

        elif name == 'Рулонный утеплитель':
            name_1 = ['рулон','х8300мм','х7380мм','х6148мм','х5500мм','х12500 мм','х8250 мм']
            for k, v in dict_tovar.items():
                x = k.lower()
                for i in name_1:
                    if re.search(f"{i}\\b", x):
                        new_dict[k] = float(v)
            try:
                for k, v in new_dict.items():
                    if v == min(new_dict.values()):
                        print(k, v)
                        print('=' * 200)
                all_product(new_dict)
            except TypeError:
                    print('Таких товаров нет')

        elif name == 'Утеплитель в плитах':
            name_1 = ['х1200мм','х1220мм','x1170','х1300мм','х1230мм','1200x','/600/','плитах','пачке','мат','матах',
                      'фасадный','фасад']
            for k, v in dict_tovar.items():
                x = k.lower()
                for i in name_1:
                    try:
                        if re.search(i, x):
                            new_dict[k] = float(v)
                    except TypeError:
                        pass

            name = type_uteplitel_v_plitah()
            if name == 'Для фасада':
                name_1 = ['фасадный','фасад','linio15','linio 15','линио 15','linio-15']
                for k, v in new_dict.items():
                    x = k.lower()
                    for i in name_1:
                        if re.search(i, x):
                            penoplast_dict[k] = float(v)
            elif name == 'Тепло-звуко изоляция':

                name_1 = ['linio15','linio 15','линио 15','linio-15''фасадный', 'фасад']
                for k, v in new_dict.items():
                    count_1 = 0
                    x = k.lower()
                    for i in name_1:
                        if i in x :
                            count_1 +=1
                    if count_1 == 0:
                        penoplast_dict[k] = float(v)


            try:
                for k, v in penoplast_dict.items():
                    if v == min(penoplast_dict.values()):
                        print(k, v)
                        print('=' * 200)
                all_product(penoplast_dict)
            except TypeError:
                    print('Таких товаров нет')


    elif product == 14:
        new_dict = {}
        name_1 = ['герметик','клей-герметик','силикон','клей - герметик','монтажный','шпатлевочный', 'клей-шпатлевка']
        for i in germetiki:
            y = i.split('/')
            tovar = open_list(i)
            for i in tovar:
                search_tovar_1 = i

                search_tovar = i.lower()
                for i in name_1:
                    if i in search_tovar:
                        price = price_steklosetki(search_tovar)
                        dict_tovar[y[0] + ' ' + search_tovar_1] = price

        name = germetiki_i_silikon()

        if name == 'Акриловый герметик':
            name_1 = ['акриловый']
            name_2 = ['кровельный','высокотемпературный','шпаклевочный','клей-шпатлевка','виброакустический',
                      'пароизоляционный','дерева']
            for k, v in dict_tovar.items():
                x = k.lower()
                for i in name_1:
                    count_1 = 0
                    if i in x:
                        for y in name_2:
                            if y in x:
                                count_1+=1
                        if count_1 == 0:
                            new_dict[k] = float(v)

        elif name == 'Силиконовый герметик':
            name_1 = ['силиконовый']
            name_2 = ['кровельный', 'высокотемпературный','кровли','виброакустический']
            for k, v in dict_tovar.items():
                x = k.lower()
                for i in name_1:
                    count_1 = 0
                    if i in x:
                        for y in name_2:
                            if y in x:
                                count_1 += 1
                        if count_1 == 0:
                            new_dict[k] = float(v)

        elif name == 'Клей-ГЕРМЕТИК':
            name_1 = ['клей-герметик','жидкие гвозди','purocol','монтажный',]
            name_2 = ['кровельный', 'высокотемпературный','кровли','виброакустический']
            for k, v in dict_tovar.items():
                x = k.lower()
                for i in name_1:
                    count_1 = 0
                    if i in x:
                        for y in name_2:
                            if y in x:
                                count_1 += 1
                        if count_1 == 0:
                            new_dict[k] = float(v)

        elif name == 'Клей-Шпатлёвка':
            name_1 = ['шпатлевочный', 'клей-шпатлевка']
            for k, v in dict_tovar.items():
                x = k.lower()
                for i in name_1:
                    if i in x:
                        new_dict[k] = float(v)

        elif name == 'Кровельные,высокотемпературные,виброакустические':
            name_1 = ['кровельный', 'высокотемпературный','кровли','виброакустический']
            for k, v in dict_tovar.items():
                x = k.lower()
                for i in name_1:
                    if i in x:
                        new_dict[k] = float(v)

        elif name == 'Для дерева(цветные)':
            name_1 = ['дерева',]
            for k, v in dict_tovar.items():
                x = k.lower()
                for i in name_1:
                    if i in x:
                        new_dict[k] = float(v)

        try:
            for k, v in new_dict.items():
                if v == min(new_dict.values()):
                    print(k, v)
                    print('=' * 200)
            all_product(new_dict)
        except TypeError:
            print('Таких товаров нет')


    elif product == 15:
        new_dict = {}
        name_1 = ['герметик', 'клей-герметик', 'силикон', 'клей - герметик', 'монтажный', 'шпатлевочный',
                  'клей-шпатлевка']
        for i in malyarka_i_ukrivka:
            y = i.split('/')
            tovar = open_list(i)
            for i in tovar:
                search_tovar_1 = i

                search_tovar = i.lower()
                for i in name_1:
                    if i in search_tovar:
                        price = price_steklosetki(search_tovar)
                        dict_tovar[y[0] + ' ' + search_tovar_1] = price
    elif product == 16:
        open_list('data_fishka_remonta/Уголки и маяки.csv')
        open_list('data_mamont/Маяки штукатурные.csv')
        open_list('data_postroyka/Маяки.csv')
        open_list('data_startStroi/Уголки, маяки.csv')
        open_list('data_stroyBaza/Маяки.csv')
    elif product == 17:
        open_list('data_fishka_remonta/Клей для утеплителя.csv')
        open_list('data_mamont/Клеевые смеси.csv')
        open_list('data_postroyka/Клей для утеплителя.csv')
        open_list('data_startStroi/Строительные смеси.csv')
    return dict_tovar



